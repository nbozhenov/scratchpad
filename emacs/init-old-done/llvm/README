Взято из llvm-trunk-а 02.12.2014
